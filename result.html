<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resultado da VotaÃ§Ã£o</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root {
Â  --bg: radial-gradient(circle at top, #3a1515, #120707);
Â  --card: rgba(255,255,255,.06);
Â  --gold: #e0c07a;
Â  --text: #fff;
}

* {
Â  box-sizing: border-box;
Â  font-family: 'Segoe UI', Arial, sans-serif;
}

body {
Â  margin: 0;
Â  background: var(--bg);
Â  color: var(--text);
Â  min-height: 100vh;
Â  display: flex;
Â  justify-content: center;
Â  align-items: center;
}

.container {
Â  width: 100%;
Â  max-width: 900px;
Â  padding: 16px;
}

.card {
Â  background: var(--card);
Â  backdrop-filter: blur(14px);
Â  border-radius: 22px;
Â  padding: 32px 24px;
Â  box-shadow: 0 25px 50px rgba(0,0,0,.45);
Â  animation: fadeUp .5s ease;
}

@keyframes fadeUp {
Â  from {opacity:0; transform: translateY(30px);}
Â  to {opacity:1; transform: translateY(0);}
}

.title {
Â  font-size: 26px;
Â  font-weight: 800;
Â  color: var(--gold);
Â  text-align: center;
Â  margin-bottom: 24px;
}

.input-box {
Â  display: flex;
Â  gap: 10px;
Â  margin-bottom: 24px;
}

input {
Â  flex: 1;
Â  padding: 14px;
Â  border-radius: 14px;
Â  border: none;
Â  outline: none;
Â  font-size: 16px;
}

button {
Â  padding: 14px 22px;
Â  border-radius: 14px;
Â  border: none;
Â  background: linear-gradient(135deg, #f0d58f, #c7a457);
Â  font-weight: 800;
Â  cursor: pointer;
}

.result {
Â  background: rgba(255,255,255,.04);
Â  border-radius: 16px;
Â  padding: 16px;
Â  margin-bottom: 14px;
Â  border: 2px solid rgba(224,192,122,.25);
}

.name {
Â  font-size: 18px;
Â  font-weight: bold;
}

.bar {
Â  width: 100%;
Â  height: 12px;
Â  background: rgba(255,255,255,.1);
Â  border-radius: 10px;
Â  overflow: hidden;
Â  margin: 8px 0;
}

.fill {
Â  height: 100%;
Â  background: linear-gradient(90deg, #f0d58f, #c7a457);
}

.percent {
Â  font-size: 14px;
Â  opacity: .9;
}
</style>
</head>
<body>

<div class="container">
Â  <div class="card">
Â  Â  <div class="title">Resultado da VotaÃ§Ã£o</div>

Â  Â  Â  Â  <div class="input-box">
Â  Â  Â  <input type="text" id="collectionName" placeholder="Digite o nome da collection (ex: jut1)">
Â  Â  Â  <button onclick="carregarResultados()">VER</button>
Â  Â  </div>

Â  Â  Â  Â  <div id="results"></div>
Â  </div>
</div>

<script>
/* ðŸ”¥ FIREBASE CONFIG (MESMA DO VOTO) */
const firebaseConfig = {
Â  apiKey: "AIzaSyD6NAWtJ1bOD-vdVbSQuf5440XaBkg6uaU",
Â  authDomain: "enquete-fa527.firebaseapp.com",
Â  databaseURL: "https://enquete-fa527-default-rtdb.firebaseio.com",
Â  projectId: "enquete-fa527",
Â  storageBucket: "enquete-fa527.firebasestorage.app",
Â  messagingSenderId: "544422121318",
Â  appId: "1:544422121318:web:e3d0412f7bf9740e7142a7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let unsubscribe = null;

/* ðŸ“Š CARREGAR RESULTADOS */
function carregarResultados() {
Â  const collection = document.getElementById("collectionName").value.trim();
Â  if (!collection) {
Â  Â  alert("Digite o nome da collection");
Â  Â  return;
Â  }

Â  if (unsubscribe) unsubscribe();

Â  // Observa as mudanÃ§as em tempo real na collection
Â  unsubscribe = db.collection(collection).onSnapshot(snapshot => {
Â  Â  const contagem = {};
Â  Â  let total = 0;

Â  Â  snapshot.forEach(doc => {
Â  Â  Â  const nome = doc.data().nome;
Â  Â  Â  contagem[nome] = (contagem[nome] || 0) + 1;
Â  Â  Â  total++;
Â  Â  });

Â  Â  renderResultados(contagem, total);
Â  }, error => {
Â  Â  console.error("Erro ao carregar resultados:", error);
Â  Â  document.getElementById("results").innerHTML = `<p style="text-align:center;">Erro ao carregar os dados. Verifique o nome da collection.</p>`;
Â  });
}

/* ðŸŽ¨ RENDERIZA */
function renderResultados(dados, total) {
Â  const container = document.getElementById("results");
Â  container.innerHTML = "";
Â  
Â  if (total === 0 && Object.keys(dados).length === 0) {
Â  Â  container.innerHTML = `<p style="text-align:center;">A coleÃ§Ã£o estÃ¡ vazia ou nÃ£o existe votos registrados.</p>`;
Â  Â  return;
Â  }

Â  Object.keys(dados)
Â  Â  .sort((a,b) => dados[b] - dados[a])
Â  Â  .forEach(nome => {
Â  Â  Â  const votos = dados[nome];
Â  Â  Â  // CORREÃ‡ÃƒO: Utiliza .toFixed(2) para garantir duas casas decimais.
Â  Â  Â  const perc = total ? ((votos / total) * 100).toFixed(2) : '0.00';

Â  Â  Â  container.innerHTML += `
Â  Â  Â  Â  <div class="result">
Â  Â  Â  Â  Â  <div class="name">${nome} â€” ${votos} votos</div>
Â  Â  Â  Â  Â  <div class="bar">
Â  Â  Â  Â  Â  Â  <div class="fill" style="width:${perc}%"></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="percent">${perc}%</div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  });
}
</script>

</body>
</html>
