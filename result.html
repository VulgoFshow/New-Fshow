<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resultado da Vota√ß√£o</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
:root {
  --bg: radial-gradient(circle at top, #3a1515, #120707);
  --card: rgba(255,255,255,.06);
  --gold: #e0c07a;
  --text: #fff;
}
* {
  box-sizing: border-box;
  font-family: 'Segoe UI', Arial, sans-serif;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  width: 100%;
  max-width: 900px;
  padding: 16px;
}
.card {
  background: var(--card);
  backdrop-filter: blur(14px);
  border-radius: 22px;
  padding: 32px 24px;
  box-shadow: 0 25px 50px rgba(0,0,0,.45);
  animation: fadeUp .5s ease;
}
@keyframes fadeUp {
  from {opacity:0; transform: translateY(30px);}
  to {opacity:1; transform: translateY(0);}
}
.title {
  font-size: 26px;
  font-weight: 800;
  color: var(--gold);
  text-align: center;
  margin-bottom: 24px;
}
.input-box {
  display: flex;
  gap: 10px;
  margin-bottom: 24px;
}
input {
  flex: 1;
  padding: 14px;
  border-radius: 14px;
  border: none;
  outline: none;
  font-size: 16px;
}
button {
  padding: 14px 22px;
  border-radius: 14px;
  border: none;
  background: linear-gradient(135deg, #f0d58f, #c7a457);
  font-weight: 800;
  cursor: pointer;
}
.result {
  background: rgba(255,255,255,.04);
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 14px;
  border: 2px solid rgba(224,192,122,.25);
}
.name {
  font-size: 18px;
  font-weight: bold;
}
.bar {
  width: 100%;
  height: 12px;
  background: rgba(255,255,255,.1);
  border-radius: 10px;
  overflow: hidden;
  margin: 8px 0;
}
.fill {
  height: 100%;
  background: linear-gradient(90deg, #f0d58f, #c7a457);
}
.percent {
  font-size: 14px;
  opacity: .9;
}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="title">Resultado da Vota√ß√£o</div>
    <!-- INPUT DA COLLECTION -->
    <div class="input-box">
      <input type="text" id="collectionName" placeholder="Digite o nome da collection (ex: jut1)">
      <button onclick="carregarResultados()">VER</button>
    </div>
    <!-- RESULTADOS -->
    <div id="results"></div>
  </div>
</div>
<script>
/* üî• FIREBASE CONFIG (MESMA DO VOTO) */
const firebaseConfig = {
  apiKey: "AIzaSyD6NAWtJ1bOD-vdVbSQuf5440XaBkg6uaU",
  authDomain: "enquete-fa527.firebaseapp.com",
  databaseURL: "https://enquete-fa527-default-rtdb.firebaseio.com",
  projectId: "enquete-fa527",
  storageBucket: "enquete-fa527.firebasestorage.app",
  messagingSenderId: "544422121318",
  appId: "1:544422121318:web:e3d0412f7bf9740e7142a7"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
let unsubscribe = null;

/* üìä CARREGAR RESULTADOS */
function carregarResultados() {
  const collection = document.getElementById("collectionName").value.trim();
  if (!collection) {
    alert("Digite o nome da collection");
    return;
  }
  if (unsubscribe) unsubscribe();
  unsubscribe = db.collection(collection).onSnapshot(snapshot => {
    const contagem = {};
    let total = 0;
    snapshot.forEach(doc => {
      const nome = doc.data().nome;
      contagem[nome] = (contagem[nome] || 0) + 1;
      total++;
    });
    renderResultados(contagem, total);
  });
}

/* üé® RENDERIZA */
function renderResultados(dados, total) {
  const container = document.getElementById("results");
  container.innerHTML = "";
  Object.keys(dados)
    .sort((a,b) => dados[b] - dados[a])
    .forEach(nome => {
      const votos = dados[nome];
      const perc = total ? ((votos / total) * 100).toFixed(2) : 0;  // ‚Üê ALTERADO AQUI: de 1 para 2
      container.innerHTML += `
        <div class="result">
          <div class="name">${nome} ‚Äî ${votos} votos</div>
          <div class="bar">
            <div class="fill" style="width:${perc}%"></div>
          </div>
          <div class="percent">${perc}%</div>
        </div>
      `;
    });
}
</script>
</body>
</html>
