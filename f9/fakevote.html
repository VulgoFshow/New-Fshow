<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Votação</title>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f0f0f;
  color: #fff;
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 40px 20px;
}

.step { display: none; }
.step.active { display: block; }

.hero-card {
  background: #1c1c1c;
  border-radius: 16px;
  padding: 25px;
  text-align: center;
  margin-bottom: 25px;
}

.badge {
  background: #ff8c00;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 12px;
}

button {
  width: 100%;
  padding: 16px;
  border: none;
  border-radius: 12px;
  background: linear-gradient(90deg,#ff8c00,#8a2be2);
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}

button:disabled {
  opacity: .6;
  cursor: not-allowed;
}

.success-card {
  background: #1c1c1c;
  border-radius: 18px;
  padding: 40px 20px;
  text-align: center;
}
</style>
</head>

<body>

<div class="container">

  <!-- ETAPA VOTAÇÃO -->
  <section id="step-votacao" class="step active">
    <div class="hero-card">
      <span class="badge">Votação</span>
      <h1>Voto Coletivo</h1>
      <p>Ao votar, você envia apoio para todos os participantes.</p>
    </div>

    <button id="botaoVotar">VOTAR</button>
  </section>

  <!-- ETAPA SUCESSO -->
  <section id="step-sucesso" class="step">
    <div class="success-card">
      <h2>✅ Votos computados!</h2>
      <p>Obrigado por participar.</p>
      <button onclick="location.reload()">Votar novamente</button>
    </div>
  </section>

</div>

<script>
/* ================= SUPABASE ================= */

const supabase = window.supabase.createClient(
  'https://vchvvvvzulrkovjmiokg.supabase.co',
  'sb_publishable_I3Ict1JU5p_o_hoON_Dc1w__8NArqNe'
);

/* ================= PARTICIPANTES ================= */

const participantes = [
  'Gretla',
  'Lady Gagá',
  'Selca',
  'Felipe Feto'
];

/* ================= VOTAÇÃO ================= */

document.getElementById("botaoVotar").onclick = async () => {
  const btn = document.getElementById("botaoVotar");
  btn.disabled = true;
  btn.innerText = "Enviando votos...";

  const votos = [];

  participantes.forEach(nome => {
    votos.push({ participante: nome });
    votos.push({ participante: nome }); // 2 votos
  });

  const { error } = await supabase
    .from('bparedao5')
    .insert(votos);

  if (error) {
    alert(error.message);
    btn.disabled = false;
    btn.innerText = "VOTAR";
    return;
  }

  document.getElementById("step-votacao").classList.remove("active");
  document.getElementById("step-sucesso").classList.add("active");
};
</script>

</body>
</html>
