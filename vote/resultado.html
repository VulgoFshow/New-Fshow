<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resultado Parcial</title>

  <style>
    body {
      font-family: "Inter", Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 0;
      color: #222;
    }

    h1 {
      font-size: 28px;
      font-weight: 800;
      margin: 0;
      padding: 25px 20px;
      text-align: center;
      background: #ffffff;
      border-bottom: 1px solid #e5e5e5;
    }

    #totalVotos {
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      margin-top: 15px;
      color: #444;
    }

    #resultados {
      padding: 20px;
      max-width: 700px;
      margin: 0 auto;
    }

    .item {
      background: #fff;
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 18px;
      display: flex;
      gap: 18px;
      align-items: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: transform .2s;
    }

    .item:hover {
      transform: scale(1.02);
    }

    .foto {
      width: 95px;
      height: 95px;
      border-radius: 14px;
      object-fit: cover;
    }

    .info {
      flex: 1;
    }

    .nome {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .percentual {
      font-size: 17px;
      color: #666;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .barra {
      width: 100%;
      height: 10px;
      background: #e9e9e9;
      border-radius: 20px;
      overflow: hidden;
    }

    .barra-fill {
      height: 100%;
      width: 0%;
      border-radius: 20px;
      transition: width 0.6s;
      background: linear-gradient(90deg, #00d4ff, #008dbb);
    }

    .voltar {
      display: block;
      margin: 35px auto;
      width: calc(100% - 50px);
      max-width: 400px;
      background: #008dbb;
      padding: 18px;
      color: #fff;
      text-align: center;
      border-radius: 14px;
      font-size: 20px;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      transition: background .2s, transform .2s;
    }

    .voltar:hover {
      background: #006e92;
      transform: scale(1.03);
    }

  </style>
</head>

<body>

  <h1>Resultado Parcial</h1>

  <div id="totalVotos"></div>

  <div id="resultados"></div>

  <a href="enquete.html" class="voltar">Votar Novamente</a>

  <!-- FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const app = initializeApp({
      apiKey: "AIzaSyD6NAWtJ1bOD-vdVbSQuf5440XaBkg6uaU",
      authDomain: "enquete-fa527.firebaseapp.com",
      projectId: "enquete-fa527",
      storageBucket: "enquete-fa527.firebasestorage.app",
      messagingSenderId: "544422121318",
      appId: "1:544422121318:web:e3d0412f7bf9740e7142a7"
    });

    const db = getFirestore(app);

    const participantes = {
      "Kathy": {
        nome: "Kathy",
        foto: "https://record.r7.com/resizer/v2/C6SLRSQAVRG23N5MCBVJ2NH2WQ.png?auth=75dd93607b797cc8354eb96b45464ed0789baa9f596572bb447e2fa05ed77267"
      },
      "Maria": {
        nome: "Maria",
        foto: "https://medias.itatiaia.com.br/dims4/default/a6d779e/2147483647/strip/true/crop/701x395+0+21/resize/1000x563!/quality/90/?url=https%3A%2F%2Fk2-prod-radio-itatiaia.s3.us-east-1.amazonaws.com%2Fbrightspot%2F68%2F9f%2Febe23b3c40f797f6d829ba15f30a%2Fmaria-caporusso-onedrive-09-23-2025-06-06-pm.jpg"
      },
      "Fabiano": {
        nome: "Fabiano",
        foto: "https://medias.itatiaia.com.br/dims4/default/9787942/2147483647/strip/true/crop/2144x1207+8+0/resize/1000x563!/quality/90/?url=https%3A%2F%2Fk2-prod-radio-itatiaia.s3.us-east-1.amazonaws.com%2Fbrightspot%2Fba%2F59%2F3f95397f4920a32d67d87e7d8a63%2Ffabiano-moraes-4-1.jpg"
      }
    };

    const resultadosDiv = document.getElementById("resultados");
    const totalDiv = document.getElementById("totalVotos");

    function atualizar(contagem) {
      resultadosDiv.innerHTML = "";

      const total = Object.values(contagem).reduce((a, b) => a + b, 0);
      totalDiv.innerHTML = `<b>Total de votos:</b> ${total.toLocaleString("pt-BR")}`;

      Object.keys(participantes).forEach(id => {
        const votos = contagem[id] || 0;
        const porcentagem = total > 0 ? (votos / total) * 100 : 0;

        resultadosDiv.innerHTML += `
          <div class="item">
            <img class="foto" src="${participantes[id].foto}">
            <div class="info">
              <div class="nome">${participantes[id].nome}</div>
              <div class="percentual">${porcentagem.toFixed(2)}% (${votos})</div>

              <div class="barra">
                <div class="barra-fill" style="width:${porcentagem}%"></div>
              </div>
            </div>
          </div>
        `;
      });
    }

    onSnapshot(collection(db, "votos"), (snapshot) => {
      const contagem = { "Kathy": 0, "Maria": 0, "Fabiano": 0 };

      snapshot.forEach(doc => {
        const voto = doc.data().participante;
        if (voto in contagem) contagem[voto]++;
      });

      atualizar(contagem);
    });
  </script>

</body>
</html>
