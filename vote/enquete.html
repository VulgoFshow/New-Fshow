<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <title>TÃ­tulo da pÃ¡gina</title>
    <meta charset="utf-8">

<script src="https://js.hcaptcha.com/1/api.js" async defer></script>

<style>
/* ===== ANIMAÃ‡Ã•ES ===== */

@keyframes fadeSlide {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes fade {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes scaleIn {
  0% { transform: scale(0.95); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes openBox {
  0% { opacity: 0; transform: translateY(-8px) scale(0.97); }
  100% { opacity: 1; transform: translateY(0) scale(1); }
}

/* ===== GLOBAL ===== */

body {
  font-family: "Inter", Arial, sans-serif;
  background: #f5f7fa;
  margin: 0;
  padding: 24px 0;
  animation: fade 0.6s ease;
  color: #222;
  display: flex;
  justify-content: center;
}

.wrapper {
  width: 100%;
  max-width: 420px; /* ðŸ”¥ Igual ao layout da segunda imagem */
  padding: 0 14px;
}

/* ===== OPÃ‡Ã•ES ===== */

.opcao-wrapper {
  margin: 26px 0;
  border-radius: 20px;
  border: 1px solid #ddd;
  overflow: visible;
  transition: 0.2s ease;
}

.opcao {
  display: flex;
  align-items: center;
  background: #fff;
  border-radius: 20px;
  height: 160px; /* ðŸ”¥ Aumentei para ficar igual Ã  segunda imagem */
  cursor: pointer;
  padding-left: 155px; /* ðŸ”¥ posiÃ§Ã£o do texto */
  position: relative;
  transition: 0.25s;
}

.imagemOpcao {
  width: 150px;  /* ðŸ”¥ Grande e proporcional */
  height: 160px; /* ðŸ”¥ Mesmo tamanho do card */
  border-radius: 12px;
  object-fit: cover;
  position: absolute;
  left: 0;
  top: 0;
}

.textoOpcao {
  font-size: 22px;  /* ðŸ”¥ Texto maior */
  font-weight: 700;
}

.opcao-wrapper.active {
  border-color: #0bb4b9;
}

.opcao-wrapper.active .opcao {
  background: linear-gradient(135deg, #0bb4b9, #0a8d91);
  color: #fff;
}

/* ===== CAPTCHA ===== */

.captchaBox {
  display: none;
  background: #fff;
  border: 1px solid #ddd;
  border-top: none;
  border-radius: 0 0 22px 22px;
  padding: 20px;
  animation: openBox .22s ease;
}

.opcao-wrapper.active .captchaBox {
  display: block;
}

.captcha-row {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.captcha-widget {
  border: 1px dashed #999;
  padding: 16px;
  border-radius: 10px;
  width: 260px;
  text-align: center;
}

/* ===== BOTÃƒO ===== */

.botao {
  margin-top: 16px;
  background: linear-gradient(135deg, #00b6c4, #0ca1a6);
  padding: 18px 26px;
  color: #fff;
  text-align: center;
  border-radius: 14px;
  font-size: 22px;
  font-weight: 700;
  width: 100%;
  border: none;
}

.botao:active {
  transform: scale(0.97);
}

/* ===== TEXTO ABAIXO ===== */

.instrucao {
  text-align: center;
  font-size: 16px;
  color: #666;
  margin-top: 10px;
}

</style>
  </head>
  <body>

<div class="wrapper">

  <!-- TÃTULO NO TOPO -->
    <h2 style="
    max-width:980px;
    margin:0 auto 16px;
    font-size:26px;
    font-weight:800;
    text-align:center;">
    ENQUETE
  </h2>
  <h2 style="
    max-width:890;
    margin:0 auto 16px;
    font-size:26px;
    font-weight:800;
    text-align:center;">
    Quem vocÃª quer que fique em A Fazenda 17?
  </h2>

<!-- OPÃ‡ÃƒO 1 -->
<div class="opcao-wrapper" 
     data-nome="Fabiano"
     data-img="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/IEQ23WK6HJFVJPA5YMLJE5MQ24.jpg">

  <label class="opcao">
    <div class="info">
      <img class="imagemOpcao"
           src="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/IEQ23WK6HJFVJPA5YMLJE5MQ24.jpg"
           alt="Fabiano" />
      <div style="padding:12px">
        <div class="textoOpcao">Fabiano</div>
        <div class="instrucao">Clique para votar</div>
      </div>
    </div>
    <input type="radio" name="voto" value="Fabiano" />
  </label>

  <div class="captchaBox">
    <div class="captcha-row">
      <div class="captcha-left">
        <div class="h-captcha captcha-widget"
             data-sitekey="7f923220-ad3a-4dce-ac7e-cecca72a233a"></div>
      </div>

      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <button class="botao votarReal desativado" disabled>votar</button>
        <div class="processando">
          <div style="display:flex;align-items:center;gap:10px">
            <div style="width:18px;height:18px;border-radius:50%;
                 border:3px solid #eee;border-top-color:#0ca1a6;
                 animation:spin 1s linear infinite"></div>
            Enviando voto...
          </div>  
        </div>
      </div>
    </div>
  </div>
</div>

<div class="espacador"></div>


<!-- OPÃ‡ÃƒO 2 -->
<div class="opcao-wrapper" 
     data-nome="Kathy"
     data-img="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/BLHVFVNVGZCQPP3GNBAFNAKY4A.jpg">

  <label class="opcao">
    <div class="info">
      <img class="imagemOpcao"
           src="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/BLHVFVNVGZCQPP3GNBAFNAKY4A.jpg"
           alt="Kathy" />
      <div style="padding:12px">
        <div class="textoOpcao">Kathy</div>
        <div class="instrucao">Clique para votar</div>
      </div>
    </div>
    <input type="radio" name="voto" value="Kathy" />
  </label>

  <div class="captchaBox">
    <div class="captcha-row">
      <div class="captcha-left">
        <div class="h-captcha captcha-widget"
             data-sitekey="7f923220-ad3a-4dce-ac7e-cecca72a233a"></div>
      </div>

      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <button class="botao votarReal desativado" disabled>votar</button>
        <div class="processando">
          <div style="display:flex;align-items:center;gap:10px">
            <div style="width:18px;height:18px;border-radius:50%;
                 border:3px solid #eee;border-top-color:#0ca1a6;
                 animation:spin 1s linear infinite"></div>
            Enviando voto...
          </div>  
        </div>
      </div>
    </div>
  </div>
</div>

<div class="espacador"></div>


<!-- OPÃ‡ÃƒO 3 -->
<div class="opcao-wrapper" 
     data-nome="Maria"
     data-img="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/I7QMOYFUCZC65JNHUX3NUIWY6E.jpg">

  <label class="opcao">
    <div class="info">
      <img class="imagemOpcao"
           src="https://cloudfront-us-east-1.images.arcpublishing.com/newr7/I7QMOYFUCZC65JNHUX3NUIWY6E.jpg"
           alt="MariaMaria" />
      <div style="padding:12px">
        <div class="textoOpcao">Maria</div>
        <div class="instrucao">Clique para votar</div>
      </div>
    </div>
    <input type="radio" name="voto" value="Maria" />
  </label>

  <div class="captchaBox">
    <div class="captcha-row">
      <div class="captcha-left">
        <div class="h-captcha captcha-widget"
             data-sitekey="7f923220-ad3a-4dce-ac7e-cecca72a233a"></div>
      </div>

      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <button class="botao votarReal desativado" disabled>votar</button>
        <div class="processando">
          <div style="display:flex;align-items:center;gap:10px">
            <div style="width:18px;height:18px;border-radius:50%;
                 border:3px solid #eee;border-top-color:#0ca1a6;
                 animation:spin 1s linear infinite"></div>
            Enviando voto...
          </div>  
        </div>
      </div>
    </div>
  </div>
</div>



<div class="header" style="margin-top:25px">
  <h1>VocÃª vai votar em <strong id="selecionadoNome">â€”</strong></h1>
</div>

  
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp }
  from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyD6NAWtJ1bOD-vdVbVQuf5440XaBkg6uaU",
  authDomain: "enquete-fa527.firebaseapp.com",
  projectId: "enquete-fa527",
  storageBucket: "enquete-fa527.firebasestorage.app",
  messagingSenderId: "544422121318",
  appId: "1:544422121318:web:e3d0412f7bf9740e7142a7"
});

const db = getFirestore(app);

let escolha = null;
let captchaToken = null;

document.addEventListener("DOMContentLoaded", () => {
  const wrappers = document.querySelectorAll(".opcao-wrapper");
  const headerNome = document.getElementById("selecionadoNome");
  const headerImg = document.getElementById("selecionadoImg");

wrappers.forEach(wrapper => {
  wrapper.querySelector(".opcao").addEventListener("click", () => {

    headerNome.textContent = wrapper.dataset.nome;
    headerImg.src = wrapper.dataset.img;
  });
});


  wrappers.forEach(wrapper => {
    const radio = wrapper.querySelector("input[type=radio]");
    const votarBtn = wrapper.querySelector(".botao");
    const processando = wrapper.querySelector(".processando");
    const captchaContainer = wrapper.querySelector(".captcha-widget");

    votarBtn.disabled = true;
    votarBtn.classList.add("desativado");

    wrapper.querySelector(".opcao").addEventListener("click", () => {
      wrappers.forEach(w => {
        w.classList.remove("active");
        const btn = w.querySelector(".botao");
        btn.disabled = true;
        btn.classList.add("desativado");
      });

      wrapper.classList.add("active");
      radio.checked = true;
      escolha = wrapper.dataset.nome;
      headerNome.innerText = escolha;

      captchaToken = null;

      votarBtn.disabled = true;
      votarBtn.classList.add("desativado");

      captchaContainer.innerHTML = "";
      hcaptcha.render(captchaContainer, {
        sitekey: "7f923220-ad3a-4dce-ac7e-cecca72a233a",
        callback: token => {
          captchaToken = token;
          votarBtn.disabled = false;
          votarBtn.classList.remove("desativado");
        }
      });
    });

    votarBtn.addEventListener("click", async () => {
      if (!captchaToken) return;

      votarBtn.disabled = true;
      votarBtn.classList.add("desativado");
      processando.style.display = "block";

      await addDoc(collection(db, "votos"), {
        participante: escolha,
        horario: serverTimestamp()
      });

      setTimeout(() => {
        window.location.href = "resultado.html";
      }, 900);
    });
  });
});
</script>
</body>
</html>
