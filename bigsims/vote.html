<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Fshow/Votação</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
  
<link rel="icon" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png" type="image/png">
<link rel="icon" type="image/png" sizes="16x16" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">

<link rel="apple-touch-icon" sizes="57x57" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">

<link rel="icon" type="image/png" sizes="192x192" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="icon" type="image/png" sizes="512x512" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">

<meta name="theme-color" content="#8A2BE2">
<meta name="msapplication-TileColor" content="#FF8C00">
<meta name="msapplication-TileImage" content="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">

<link rel="icon" type="image/png" sizes="192x192" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="icon" type="image/png" sizes="512x512" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<link rel="mask-icon" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png" color="#ff8c00">
<link rel="manifest" href="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<meta name="msapplication-TileColor" content="#ff8c00">
<meta name="msapplication-TileImage" content="https://i.ibb.co/0Vv5RSLg/Logo-Fshow2.png">
<meta name="theme-color" content="#8a2be2">
<script src="https://www.google.com/recaptcha/api.js?render=6LevDzAsAAAAABhRU2ALuUHXSeQxGRza6-bKxGJp"></script>

<style>
/* ===== RESET E BASE ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Roboto, Arial, sans-serif;
}

html {
    scroll-behavior: smooth;
}

body {
    background: radial-gradient(circle at top, #1a1a1a 0%, #000 65%);
    color: #fff;
    min-height: 100vh;
    overflow-x: hidden;
}

.container {
    max-width: 430px;
    margin: 0 auto;
    padding: 16px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    border: 2px solid rgba(255,255,255,.1);
    border-radius: 24px;
    background: rgba(0,0,0,.35);
    backdrop-filter: blur(10px);
}

/* ===== ANIMAÇÕES (KEYFRAMES) ===== */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(50px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes scaleIn {
    from {
        opacity: 0;
        transform: scale(0.8);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes pulseCheck {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(92, 255, 122, 0.7); }
    70% { transform: scale(1.1); box-shadow: 0 0 0 15px rgba(92, 255, 122, 0); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(92, 255, 122, 0); }
}

@keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
}

/* ===== ESTRUTURA DOS STEPS ===== */
.step {
    display: none;
    opacity: 0;
}

.step.active {
    display: block;
    animation: fadeInUp 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

/* Especial para a tela de sucesso centralizar */
#step-sucesso.active {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    flex-grow: 1;
}

/* ===== HERO CARD ===== */
.hero-card {
    position: relative;
    padding: 30px 22px;
    margin: -16px -16px 25px -16px;
    overflow: hidden;
    background: linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.9)), 
                url("https://i.ibb.co/8gvrdhDw/colorsplash.png");
    background-size: cover;
    background-position: center;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.badge {
    display: inline-block;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255,255,255,0.2);
    padding: 5px 15px;
    border-radius: 30px;
    font-size: 10px;
    letter-spacing: 1px;
    text-transform: uppercase;
    animation: slideInRight 0.8s ease;
}

/* ===== CARDS DOS CANDIDATOS ===== */
.candidate-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.candidate-card {
    position: relative;
    display: flex;
    align-items: center;
    height: 90px;
    background: #1c1f26;
    border-radius: 18px;
    padding: 12px;
    cursor: pointer;
    border: 1px solid rgba(255,255,255,0.08);
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Animação de entrada em cascata */
    opacity: 0;
    animation: slideInRight 0.5s ease forwards;
}

/* Delay para cada card entrar um após o outro */
.candidate-card:nth-child(1) { animation-delay: 0.1s; }
.candidate-card:nth-child(2) { animation-delay: 0.2s; }
.candidate-card:nth-child(3) { animation-delay: 0.3s; }
.candidate-card:nth-child(4) { animation-delay: 0.4s; }

.candidate-card:hover {
    transform: translateX(8px) scale(1.02);
    background: #262a38;
    border-color: #ff005d;
    box-shadow: 0 10px 25px rgba(0,0,0,0.4);
}

.candidate-card:active {
    transform: scale(0.96);
}

.candidate-card img {
    position: absolute;
    top: 0; left: 0;
    width: 40%; height: 100%;
    object-fit: cover;
    z-index: 1;
    mask-image: linear-gradient(to right, black 70%, transparent 100%);
    -webkit-mask-image: linear-gradient(to right, black 70%, transparent 100%);
}

.candidate-info {
    position: relative;
    z-index: 2;
    margin-left: auto;
    width: 60%;
    text-align: right;
    padding-right: 10px;
}

/* ===== BOTÕES ===== */
button {
    width: 100%;
    padding: 16px;
    border-radius: 50px;
    border: none;
    font-weight: bold;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.btn-vote {
    background: linear-gradient(135deg, #ff005d, #6a00ff);
    color: white;
    box-shadow: 0 8px 15px rgba(255, 0, 93, 0.3);
}

.btn-back {
    background: rgba(255,255,255,0.05);
    color: #ccc;
    border: 1px solid rgba(255,255,255,0.1);
    margin-top: 15px;
}

.btn-back:hover {
    background: rgba(255,255,255,0.1);
    color: #fff;
}

/* ===== TELA DE SUCESSO ===== */
.success-card {
    text-align: center;
    padding: 40px 20px;
    background: rgba(255,255,255,0.03);
    border-radius: 30px;
    border: 1px solid rgba(255,255,255,0.1);
    width: 100%;
    animation: scaleIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.success-icon {
    width: 80px;
    height: 80px;
    border: 4px solid #5CFF7A;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
    color: #5CFF7A;
    margin: 0 auto 20px;
    animation: pulseCheck 2s infinite;
}

.success-card h2 {
    margin-bottom: 30px;
    background: linear-gradient(to right, #fff, #5CFF7A);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.btn-again {
    background: #fff;
    color: #000;
    max-width: 200px;
    margin: 0 auto;
}

/* ===== CAPTCHA ===== */
.captcha-container {
    display: flex;
    justify-content: center;
    padding: 20px;
    background: rgba(0,0,0,0.2);
    border-radius: 20px;
    margin: 20px 0;
    animation: fadeInUp 0.8s ease;
}
</style>
</head>
<body>

    <div class="container">
        <section id="step-votacao" class="step active">
            <div class="hero-card">
                <span class="badge">Votação</span>
                <h1>Quem deve ser ELIMINADO?</h1>
                <p>Você pode votar quantas vezes quiser.</p>
            </div>
            <div class="candidate-list" id="candidate-list">
                </div>
        </section>

        <section id="step-confirmacao" class="step">
            <div class="hero-card">
                <span class="badge">Votação</span>
                <h1>Opção selecionada</h1>
                <p>Passe pelo captcha para enviar o seu voto</p>
            </div>
            <h2 style="margin-bottom: 15px;">Confirme seu voto</h2>
            <div id="selected-candidate-card"></div>
            
            <div class="captcha-container">
                <div class="g-recaptcha" data-sitekey="6Lev1DUsAAAAANzB2nhPDsKVzXZP0daxuDMCil1a" data-callback="onCaptchaSuccess" data-theme="dark"></div>
            </div>

            <button class="btn-back" onclick="changeStep('votacao')">
                ↺ Alterar voto
            </button>
        </section>

        <section id="step-sucesso" class="step">
            <div class="success-card">
                <div class="success-icon">✓</div>
                <h2>Voto computado com sucesso!</h2>
                <button class="btn-again" onclick="resetVotacao()">Votar novamente</button>
            </div>
        </section>
    </div>

    <script>
        const VOTACAO_ABERTA = true;

        // Inicialização Supabase
        const _supabase = window.supabase.createClient(
            'https://rvizztgogtepktmnfdhc.supabase.co',
            'sb_publishable_5vd5eUluXqj2Wq0xTaWwdA_QUpGP9kP'
        );

        const candidatos = [
            { id: 1, nome: 'Virgínia Fonte Seca', time: 'Perdeu a prova', foto: 'https://github.com/VulgoFshow/New-Fshow/blob/main/bigsims/Virginia.png?raw=true' },
            { id: 2, nome: 'Rodrigo Telespectador', time: 'Indicado pela líder', foto: 'https://github.com/VulgoFshow/New-Fshow/blob/main/bigsims/Rodrigo.png?raw=true' },
            { id: 3, nome: 'Andressa Burach', time: 'Mais votada da casa', foto: 'https://github.com/VulgoFshow/New-Fshow/blob/main/bigsims/Andressa.png?raw=true' }
        ];

        let candidatoSelecionado = null;

function verificarVotacao() {
    if (!VOTACAO_ABERTA) {
        window.location.href = "fechada.html"; 
        return false;
    }
    return true;
}

        function renderCandidates() {
            const list = document.getElementById('candidate-list');
            if (!list) return;

            list.innerHTML = candidatos.map(c => `
                <div class="candidate-card" onclick="selectCandidate(${c.id})">
                    <img src="${c.foto}" alt="${c.nome}">
                    <div class="candidate-info">
                        <h3>${c.nome}</h3>
                        <p>${c.time}</p>
                    </div>
                </div>
            `).join('');
        }

        function selectCandidate(id) {
            if (!verificarVotacao()) return;

            candidatoSelecionado = candidatos.find(c => c.id === id);
            const container = document.getElementById('selected-candidate-card');
            
            container.innerHTML = `
                <div class="candidate-card">
                    <img src="${candidatoSelecionado.foto}" alt="${candidatoSelecionado.nome}">
                    <div class="candidate-info">
                        <h3>${candidatoSelecionado.nome}</h3>
                        <p>${candidatoSelecionado.time}</p>
                    </div>
                </div>
            `;

            changeStep('confirmacao');
        }

        function changeStep(stepId) {
            // Remove active de todos
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            
            // Adiciona no destino
            const target = document.getElementById(`step-${stepId}`);
            if (target) {
                target.classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        async function onCaptchaSuccess() {
            if (!candidatoSelecionado) return;

            const { error } = await _supabase
                .from('simsp1')
                .insert([{ candidato_id: candidatoSelecionado.id }]);

            if (error) {
                alert("Erro ao votar: " + error.message);
                grecaptcha.reset();
            } else {
                changeStep('sucesso');
            }
        }

        function resetVotacao() {
            candidatoSelecionado = null;
            if (typeof grecaptcha !== 'undefined') grecaptcha.reset();
            changeStep('votacao');
        }

        document.addEventListener('DOMContentLoaded', renderCandidates);
    </script>
</body>
</html>
